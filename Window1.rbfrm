#tag WindowBegin Window Window1   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   True   Composite       =   True   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   498   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   1408782882   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "MAL Client OS X"   Visible         =   True   Width           =   657   Begin maintoolbar maintoolbar1      Enabled         =   True      Height          =   47      Index           =   -2147483648      InitialParent   =   ""      Left            =   4      LockedInPosition=   False      Scope           =   0      TabPanelIndex   =   0      Top             =   -73      Visible         =   True      Width           =   207   End   Begin Timer Timer1      Height          =   32      Index           =   -2147483648      InitialParent   =   ""      Left            =   682      LockedInPosition=   False      Mode            =   2      Period          =   900000      Scope           =   0      TabPanelIndex   =   0      Top             =   254      Width           =   32   End   Begin httpsocket socket1      Address         =   ""      Height          =   32      Index           =   -2147483648      Left            =   384      LockedInPosition=   False      Port            =   0      Scope           =   0      TabPanelIndex   =   0      Top             =   -51      Width           =   32      yield           =   0   End   Begin PagePanel PagePanel1      AutoDeactivate  =   True      Enabled         =   True      Height          =   498      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   0      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      PanelCount      =   2      Panels          =   ""      Scope           =   0      TabIndex        =   13      TabPanelIndex   =   0      Top             =   0      Value           =   0      Visible         =   True      Width           =   657      Begin Listbox yourlist         AutoDeactivate  =   True         AutoHideScrollbars=   True         Bold            =   ""         Border          =   False         ColumnCount     =   1         ColumnsResizable=   False         ColumnWidths    =   ""         DataField       =   ""         DataSource      =   ""         DefaultRowHeight=   -1         Enabled         =   True         EnableDrag      =   ""         EnableDragReorder=   ""         GridLinesHorizontal=   0         GridLinesVertical=   0         HasHeading      =   False         HeadingIndex    =   -1         Height          =   440         HelpTag         =   ""         Hierarchical    =   True         Index           =   -2147483648         InitialParent   =   "PagePanel1"         InitialValue    =   ""         Italic          =   ""         Left            =   0         LockBottom      =   True         LockedInPosition=   False         LockLeft        =   True         LockRight       =   True         LockTop         =   True         RequiresSelection=   ""         Scope           =   0         ScrollbarHorizontal=   ""         ScrollBarVertical=   True         SelectionType   =   0         TabIndex        =   0         TabPanelIndex   =   1         TabStop         =   True         TextFont        =   "System"         TextSize        =   11         TextUnit        =   0         Top             =   34         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   657         _ScrollWidth    =   -1      End      Begin BevelButton DeleteBut         AcceptFocus     =   False         AutoDeactivate  =   True         BackColor       =   0         Bevel           =   0         Bold            =   False         ButtonType      =   0         Caption         =   "Remove"         CaptionAlign    =   3         CaptionDelta    =   0         CaptionPlacement=   1         Enabled         =   False         HasBackColor    =   False         HasMenu         =   0         Height          =   18         HelpTag         =   ""         Icon            =   ""         IconAlign       =   0         IconDX          =   0         IconDY          =   0         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   False         Left            =   7         LockBottom      =   True         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   False         MenuValue       =   0         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   1         TabStop         =   True         TextColor       =   0         TextFont        =   "System"         TextSize        =   11         TextUnit        =   0         Top             =   477         Underline       =   False         Value           =   False         Visible         =   True         Width           =   65      End      Begin BevelButton UpdateBut         AcceptFocus     =   False         AutoDeactivate  =   True         BackColor       =   0         Bevel           =   4         Bold            =   False         ButtonType      =   0         Caption         =   "Update"         CaptionAlign    =   3         CaptionDelta    =   0         CaptionPlacement=   1         Enabled         =   False         HasBackColor    =   False         HasMenu         =   0         Height          =   18         HelpTag         =   ""         Icon            =   ""         IconAlign       =   2         IconDX          =   0         IconDY          =   0         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   False         Left            =   76         LockBottom      =   True         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   False         MenuValue       =   0         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   1         TabStop         =   True         TextColor       =   0         TextFont        =   "System"         TextSize        =   11         TextUnit        =   0         Top             =   477         Underline       =   False         Value           =   False         Visible         =   True         Width           =   71      End      Begin Listbox results         AutoDeactivate  =   True         AutoHideScrollbars=   True         Bold            =   False         Border          =   False         ColumnCount     =   1         ColumnsResizable=   ""         ColumnWidths    =   ""         DataField       =   ""         DataSource      =   ""         DefaultRowHeight=   -1         Enabled         =   True         EnableDrag      =   ""         EnableDragReorder=   ""         GridLinesHorizontal=   0         GridLinesVertical=   0         HasHeading      =   True         HeadingIndex    =   -1         Height          =   432         HelpTag         =   ""         Hierarchical    =   True         Index           =   -2147483648         InitialParent   =   "PagePanel1"         InitialValue    =   ""         Italic          =   False         Left            =   0         LockBottom      =   True         LockedInPosition=   False         LockLeft        =   True         LockRight       =   True         LockTop         =   True         RequiresSelection=   ""         Scope           =   0         ScrollbarHorizontal=   ""         ScrollBarVertical=   True         SelectionType   =   0         TabIndex        =   0         TabPanelIndex   =   2         TabStop         =   True         TextFont        =   "System"         TextSize        =   11         TextUnit        =   2         Top             =   42         Underline       =   ""         UseFocusRing    =   False         Visible         =   True         Width           =   657         _ScrollWidth    =   -1      End      Begin PushButton SearchButton         AutoDeactivate  =   True         Bold            =   ""         Cancel          =   ""         Caption         =   "Search"         Default         =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   569         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   True         LockTop         =   ""         Scope           =   0         TabIndex        =   3         TabPanelIndex   =   2         TabStop         =   True         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   10         Underline       =   ""         Visible         =   True         Width           =   80      End      Begin TextField SearchBox         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         BackColor       =   16777215         Bold            =   ""         Border          =   True         CueText         =   "Enter a Search Term Here"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   69         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   True         LockTop         =   ""         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   4         TabPanelIndex   =   2         TabStop         =   True         Text            =   ""         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   10         Underline       =   ""         UseFocusRing    =   True         Visible         =   True         Width           =   488      End      Begin StaticText LblSearch         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   12         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   ""         Scope           =   0         TabIndex        =   5         TabPanelIndex   =   2         Text            =   "Search:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   12         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin ProgressWheel SearchWheel         AutoDeactivate  =   True         Enabled         =   True         Height          =   16         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Left            =   630         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   True         LockTop         =   ""         Scope           =   0         TabIndex        =   6         TabPanelIndex   =   2         TabStop         =   True         Top             =   478         Visible         =   False         Width           =   16      End      Begin StaticText searchresults         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   10         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   True         LockTop         =   False         Multiline       =   ""         Scope           =   0         TabIndex        =   7         TabPanelIndex   =   2         Text            =   ""         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   11         TextUnit        =   0         Top             =   476         Underline       =   ""         Visible         =   True         Width           =   582      End      Begin BevelButton MUpdate         AcceptFocus     =   False         AutoDeactivate  =   True         BackColor       =   0         Bevel           =   0         Bold            =   False         ButtonType      =   0         Caption         =   "MUpdate"         CaptionAlign    =   3         CaptionDelta    =   0         CaptionPlacement=   1         Enabled         =   False         HasBackColor    =   False         HasMenu         =   0         Height          =   18         HelpTag         =   "Post a Melative Update"         Icon            =   ""         IconAlign       =   0         IconDX          =   0         IconDY          =   0         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   False         Left            =   150         LockBottom      =   True         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         MenuValue       =   0         Scope           =   0         TabIndex        =   3         TabPanelIndex   =   1         TabStop         =   True         TextColor       =   0         TextFont        =   "System"         TextSize        =   11         TextUnit        =   0         Top             =   477         Underline       =   False         Value           =   False         Visible         =   True         Width           =   67      End      Begin StaticText StaticText1         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   6         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   ""         Scope           =   0         TabIndex        =   4         TabPanelIndex   =   1         Text            =   "Filter:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   12         TextUnit        =   0         Top             =   8         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin PopupMenu filtermenu         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   19         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         InitialValue    =   "watching\rcompleted\ron-hold\rdropped\rplan to watch"         Italic          =   ""         Left            =   49         ListIndex       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Scope           =   0         TabIndex        =   5         TabPanelIndex   =   1         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   7         Underline       =   ""         Visible         =   True         Width           =   126      End      Begin ProgressWheel listwheel         AutoDeactivate  =   True         Enabled         =   True         Height          =   16         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Left            =   633         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Scope           =   0         TabIndex        =   6         TabPanelIndex   =   1         TabStop         =   True         Top             =   477         Visible         =   False         Width           =   16      End   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Close()		  quit		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.HasToolbarButton = false		  dim sysVersion as Integer		  // Set Interface		  If System.Gestalt("sysv", sysVersion) and sysVersion >= &h1050 then		    SetWindow.SetRoundWindowTopBottom(self,42,24 )		    		  else		    //Revert to metal window if Mac OS X is 10.4 or 10.3		    SetWindow.Metal(self,true)		    		  end if		  		  me.title = "MAL Client OS X - (Logged in as " + app.memusername + ")"		  		  		  //set up yourlist listbox		  yourlist.columncount=6		  yourlist.columnwidths="0,58%,10%,12%,10%,10%"		  yourlist.HasHeading=True		  yourlist.Heading(0)="ID"		  yourlist.Heading(1)="Title"		  yourlist.Heading(2)="Type"		  yourlist.Heading(3)="Episodes"		  yourlist.Heading(4)="Progress"		  yourlist.Heading(5)="Rating"		  yourlist.Column(0).UserResizable=false		  		  //Populate data to the list		  refreshlist(false)		  		  //set up Search listbox		  results.columncount=5		  results.columnwidths="0,70%,10%,10%,10%"		  results.HasHeading=True		  results.Heading(0)="ID"		  results.Heading(1)="Name of Series"		  results.Heading(2)="Episodes"		  results.Heading(3)="Type"		  results.Heading(4)="Rating"		  results.Column(0).UserResizable=false		End Sub	#tag EndEvent	#tag MenuHandler		Function FileClose() As Boolean Handles FileClose.Action			me.close			Return True					End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Sub errboxshow(errtitle as string, errmsg as string)		  Dim b as MessageDialogButton //for handling the result		  // no search term error		  Dim d as New MessageDialog //declare the MessageDialog object		  d.icon=MessageDialog.GraphicCaution //display warning icon		  d.ActionButton.Caption="OK"		  d.Message=errtitle		  d.Explanation=errmsg		  b=d.ShowModalWithin(self.TrueWindow)		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub filterlist()		  //Populate data to the list		  // clear list		  yourlist.DeleteAllRows		  dim XML as new XMLDocument		  xml.LoadXML(listdata)		  r = getXMLroot(xml)		  p = getList(r)		  c = p.Length - 1		  yourlist.visible = false		  for i = 0 to c		    d = parseAnime(p.Item(i))		    If d.Value("watched_status") = filtermenu.text then		      Yourlist.AddRow(d.Value("id"))		      Yourlist.Cell(Yourlist.LastIndex, 1) = d.Value("title")		      Yourlist.Cell(Yourlist.LastIndex, 2) = d.Value("type")		      // To avoid division by zero error		      If d.Value("episodes") = 0 then		        Yourlist.Cell(Yourlist.LastIndex, 3) = d.Value("watched_episodes") + "/ - "		        Yourlist.Cell(Yourlist.LastIndex, 4) = " - %"		      else		        Yourlist.Cell(Yourlist.LastIndex, 3) = d.Value("watched_episodes") + "/" + d.Value("episodes")		        Yourlist.Cell(Yourlist.LastIndex, 4) = cstr(round(val(d.Value("watched_episodes"))/val(d.value("episodes"))*100) )+ "%"		      end if		      Yourlist.Cell(Yourlist.LastIndex, 5) = d.Value("score")		    else		    end if		  next		  yourlist.visible = true		  xml = nil		  r = nil		  d = nil		  p = nil		  		  //Sort list		  Yourlist.ColumnsortDirection(1)=ListBox.sortascending		  Yourlist.SortedColumn=1//sort by name		  Yourlist.Sort		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub performsearch()		  searchwheel.visible = true		  if searchbox.text = "" then		    errboxshow("There is a problem with your search!","You forgot to enter a search term!")		    searchwheel.visible = false		  Else		    // perform search		    socket1.yield = true		    dim data as string		    dim s as string		    // Remove old results		    results.DeleteAllRows		    // retrieve results		    socket1.setrequestheader "Authorization","Basic " + app.loginenc		    s = EncodeURLComponent(searchbox.text )		    data= socket1.get( "http://mal-api.com/anime/search?q=" + s + "&format=xml",10)		    If data is nil then		      // if data cannot be retrieved		      errboxshow("There is a problem with your search!","Cannot retrieve data. Check your internet connection and try your search again.")		      searchwheel.visible = false		    else		      // Populate Search Results		      dim XML as new XMLDocument		      XML.LoadXML(Data)		      r = getXMLroot(xml)		      p = getSearchList(r)		      		      c = p.Length - 1		      If p.length = 0 then		        searchresults.text = "No titles found for " + searchbox.text		      else		        searchresults.text =  cstr(p.Length) +  " title(s) found for " + searchbox.text		      end if		      //populate to results listbox		      results.visible = false		      for i = 0 to c		        d = parseAnime(p.Item(i))		        results.AddRow(d.Value("id"))		        results.Cell(results.LastIndex, 1) = d.Value("title")		        if d.value("episodes") = "0" then		          results.Cell(results.LastIndex, 2) = "-"		        else		          results.Cell(results.LastIndex, 2) = d.Value("episodes")		        end if		        results.Cell(results.LastIndex, 3) = d.Value("type")		        results.Cell(results.LastIndex, 4) = d.Value("members_score")		        results.Cell(results.LastIndex, 5) = d.Value("status")		      next		      results.visible = true		      searchwheel.visible = false		      xml = nil		      r = nil		      d = nil		      p = nil		    end if		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub refreshlist(silent as boolean)		  // Refreshes the list every 15 minutes		  // Obtain your anime list		  socket1.yield = true		  listwheel.visible = true		  listdata= socket1.get("http://mal-api.com/animelist/" + prefs.stringusername + "?format=xml" ,10)		  // debugyourlist.text = data		  If listdata is nil then		    if silent = true then		    else		      errboxshow("There is a problem while retreving your list",   "Unable to refresh your Anime List. Make sure you are connected to the internet!")		    end if		    filtermenu.enabled = false		    listwheel.visible = false		  else		    //Populate data to the list		    // clear list		    filtermenu.enabled = true		    dim XML as new XMLDocument		    yourlist.DeleteAllRows		    xml.LoadXML(listdata)		    r = getXMLroot(xml)		    p = getList(r)		    c = p.Length - 1		    yourlist.visible = false		    for i = 0 to c		      d = parseAnime(p.Item(i))		      If d.Value("watched_status") = filtermenu.text then		        Yourlist.AddRow(d.Value("id"))		        Yourlist.Cell(Yourlist.LastIndex, 1) = d.Value("title")		        Yourlist.Cell(Yourlist.LastIndex, 2) = d.Value("type")		        // To avoid division by zero error		        If d.Value("episodes") = 0 then		          Yourlist.Cell(Yourlist.LastIndex, 3) = d.Value("watched_episodes") + "/ - "		          Yourlist.Cell(Yourlist.LastIndex, 4) = " - %"		        else		          Yourlist.Cell(Yourlist.LastIndex, 3) = d.Value("watched_episodes") + "/" + d.Value("episodes")		          Yourlist.Cell(Yourlist.LastIndex, 4) = cstr(round(val(d.Value("watched_episodes"))/val(d.value("episodes"))*100) )+ "%"		        end if		        Yourlist.Cell(Yourlist.LastIndex, 5) = d.Value("score")		      else		      end if		    next		    yourlist.visible = true		    xml = nil		    r = nil		    d = nil		    p = nil		    //Sort list		    Yourlist.ColumnsortDirection(1)=ListBox.sortascending		    Yourlist.SortedColumn=1 //sort by name		    Yourlist.Sort		    listwheel.visible = false		  end if		  		  		  		End Sub	#tag EndMethod	#tag Property, Flags = &h0		c As Integer	#tag EndProperty	#tag Property, Flags = &h0		d As dictionary	#tag EndProperty	#tag Property, Flags = &h0		i As Integer	#tag EndProperty	#tag Property, Flags = &h0		listdata As string	#tag EndProperty	#tag Property, Flags = &h0		p As XmlNodeList	#tag EndProperty	#tag Property, Flags = &h0		r As XmlNode	#tag EndProperty#tag EndWindowCode#tag Events maintoolbar1	#tag Event		Sub Action(item As ToolItem)		  Select Case Item.Name		  Case "yourlist"		    me.yourlist.Pushed = true		    me.searchtblbutton.Pushed = false		    pagepanel1.value = 0		  Case "searchtblbutton"		    me.yourlist.Pushed = false		    me.searchtblbutton.Pushed = true		    pagepanel1.value = 1		  Case "Refreshbut"		    refreshlist(false)		    Timer1.Reset		  End Select		End Sub	#tag EndEvent#tag EndEvents#tag Events Timer1	#tag Event		Sub Action()		  refreshlist(true)		End Sub	#tag EndEvent#tag EndEvents#tag Events yourlist	#tag Event		Sub Change()		  If yourlist.listindex = -1 then		    updatebut.enabled = false		    deletebut.enabled = false		    mupdate.enabled = false		  else		    updatebut.enabled = true		    deletebut.enabled = true		    mupdate.enabled = true		  End If		End Sub	#tag EndEvent	#tag Event		Function KeyDown(Key As String) As Boolean		  if key = chr(13) then		    If yourlist.listindex = -1 then		    else		      app.lookupwindowshow( me.cell(me.listindex,0))		    end if		  end if		End Function	#tag EndEvent	#tag Event		Sub DoubleClick()		  If yourlist.listindex = -1 then		  else		    app.lookupwindowshow( me.cell(me.listindex,0))		  end if		End Sub	#tag EndEvent	#tag Event		Function CellBackgroundPaint(g As Graphics, row As Integer, column As Integer) As Boolean		  if row mod 2 = 0 then		    g.forecolor = App.GetThemeColor(app.kThemeBrushListViewOddRowBackground)		  else		    g.forecolor = App.GetThemeColor(app.kThemeBrushListViewEvenRowBackground)		  end		  g.fillrect(0,0,g.width,g.height)		End Function	#tag EndEvent#tag EndEvents#tag Events DeleteBut	#tag Event		Sub Action()		  If yourlist.listindex = -1 then		    Msgbox "You need to select a title before you can remove it"		  else		    dim aniname as string		    aniname = yourlist.cell(yourlist.listindex,1)		    Dim d as New MessageDialog //declare the MessageDialog object		    Dim b as MessageDialogButton //for handling the result		    d.icon=MessageDialog.GraphicCaution //display warning icon		    d.ActionButton.Caption="Delete"		    d.CancelButton.Visible=True    //show the Cancel button		    d.Message="Are you sure you want to delete " + aniname + " from your list?"		    d.Explanation="Once deleted, this operation cannot be undone."		    b=d.ShowModalWithin(self.TrueWindow) //display the dialog		    Select Case b //determine which button was pressed.		    Case d.ActionButton		      //user pressed Delete		      //perform delete		      dim aniid as string		      aniid = yourlist.cell(yourlist.listindex,0)		      dim form as new dictionary		      form = New Dictionary		      form.value("_method") = "DELETE"		      // setup the socket to POST the form		      socket1.setFormData form		      socket1.setrequestheader "Authorization","Basic " + app.loginenc		      socket1.post ("http://mal-api.com/animelist/anime/" + AniID )		      form = nil		      If socket1.httpstatuscode = 200 then		        Msgbox aniname + " is removed from your list."		        window1.refreshlist(true)		      else		        app.errboxshow("There was a problem when we were trying to remove a title.", "Check your internet connection and try removing that title again.")		      end if		    Case d.CancelButton		      //user pressed Cancel		    End select		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events UpdateBut	#tag Event		Sub Action()		  If yourlist.listindex = -1 then		    Msgbox "You need to select a title before you can update it"		  else		    dim w as new updatewindow		    dim aniid as string		    aniid = yourlist.cell(yourlist.listindex,0)		    w.aniid = aniid		    w.upmethod = "Update"		    w.seriestitle.text = "Updating Information for: "+  yourlist.cell(yourlist.listindex,1)		    If prefs.BooleanMelUpdates = true then		      w.titleprob = yourlist.cell(yourlist.listindex,1)		    end if		    w.loadinfo()		    w.ShowModalWithin(self.TrueWindow)		    		    if w.doIt = true then		      		      refreshlist(true)		    end if		    w.close		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events results	#tag Event		Sub DoubleClick()		  If results.listindex = -1 then		  else		    app.lookupwindowshow( me.cell(me.listindex,0))		  end if		  		End Sub	#tag EndEvent	#tag Event		Function KeyDown(Key As String) As Boolean		  if key = chr(13) then		    If results.listindex = -1 then		    else		      app.lookupwindowshow( me.cell(me.listindex,0))		    end if		  end if		End Function	#tag EndEvent	#tag Event		Function CellBackgroundPaint(g As Graphics, row As Integer, column As Integer) As Boolean		  if row mod 2 = 0 then		    g.forecolor = App.GetThemeColor(app.kThemeBrushListViewOddRowBackground)		  else		    g.forecolor = App.GetThemeColor(app.kThemeBrushListViewEvenRowBackground)		  end		  g.fillrect(0,0,g.width,g.height)		End Function	#tag EndEvent#tag EndEvents#tag Events SearchButton	#tag Event		Sub Action()		  performsearch		End Sub	#tag EndEvent#tag EndEvents#tag Events SearchBox	#tag Event		Function KeyDown(Key As String) As Boolean		  if key = chr(13) then		    Searchbutton.Push		  end if		End Function	#tag EndEvent#tag EndEvents#tag Events MUpdate	#tag Event		Sub Action()		  If prefs.BooleanMelUpdates = true then		    dim mu as new melupdatewindow		    mu.truewindow.Title = "Post Melative Update - " + yourlist.cell(yourlist.listindex,1)		    mu.titletext.Text = yourlist.cell(yourlist.listindex,1)		    mu.checkbox1.value = true		    mu.Show		  else		    errboxshow("MAL Client OS X was unable to post a melative update on this series.","You must configure your melative credentials before you can post a melative update on this series. Configure your credentials, enable melative updating and try again.")		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events filtermenu	#tag Event		Sub Change()		  filterlist		End Sub	#tag EndEvent#tag EndEvents