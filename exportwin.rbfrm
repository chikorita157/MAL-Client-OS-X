#tag WindowBegin Window exportwin   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   True   Composite       =   True   Frame           =   8   FullScreen      =   False   HasBackColor    =   False   Height          =   1.1e+2   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "Export Anime List"   Visible         =   True   Width           =   4.64e+2   Begin StaticText StaticText1      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   18      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Multiline       =   ""      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   "Exporting Anime Listâ€¦"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   14      Underline       =   ""      Visible         =   True      Width           =   135   End   Begin ProgressBar ProgressBar1      AutoDeactivate  =   True      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   18      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Maximum         =   100      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Top             =   46      Value           =   0      Visible         =   True      Width           =   426   End   Begin PushButton PushButton1      AutoDeactivate  =   True      Bold            =   ""      Cancel          =   True      Caption         =   "Cancel"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   364      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   78      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin httpsocket socket1      Address         =   ""      Enabled         =   True      Height          =   32      Index           =   -2147483648      Left            =   111      LockedInPosition=   False      Port            =   0      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Top             =   65      Visible         =   True      Width           =   32      yield           =   0   End   Begin Timer Timer1      Enabled         =   True      Height          =   32      Index           =   -2147483648      Left            =   264      LockedInPosition=   False      Mode            =   1      Period          =   0      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      Top             =   85      Visible         =   True      Width           =   32   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  // Set Transparency to give Sheet Window effect.		  self.alpha = .95		  		End Sub	#tag EndEvent	#tag Method, Flags = &h21		Private Sub export()		  // Export Anime List		  Dim dlg as New SaveAsDialog		  dim f as folderItem		  socket1.yield = true		  dlg.InitialDirectory=SpecialFolder.Documents		  dlg.promptText="Where do you want to save the exported anime list?"		  dlg.SuggestedFileName="animelist - " + app.prefs.root.GetString("Username") + ".xml"		  dlg.Title="AnimeList Export"		  dlg.Filter=".xml" //defined as a file type in FileTypes1 File Type Set		  f=dlg.ShowModal()		  If f <> Nil then		    socket1.get("http://mal-api.com/animelist/" + app.prefs.root.GetString("Username") + "?format=xml" ,f)		    f = nil		  Else		    //user canceled		    hide		  End if		End Sub	#tag EndMethod#tag EndWindowCode#tag Events PushButton1	#tag Event		Sub Action()		  hide		End Sub	#tag EndEvent#tag EndEvents#tag Events socket1	#tag Event		Sub ReceiveProgress(bytesReceived as integer, totalBytes as integer, newData as string)		  progressbar1.Maximum = totalbytes		  progressbar1.value = bytesreceived		End Sub	#tag EndEvent	#tag Event		Sub DownloadComplete(url as string, httpStatus as integer, headers as internetHeaders, file as folderItem)		  If Progressbar1.value = progressbar1.Maximum then		    hide		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events Timer1	#tag Event		Sub Action()		  export		End Sub	#tag EndEvent#tag EndEvents