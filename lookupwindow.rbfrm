#tag WindowBegin Window lookupwindow   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   True   Composite       =   True   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   458   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   1408782882   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "Anime Infomation"   Visible         =   True   Width           =   600   Begin StaticText SeriesTitle      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   209      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      Text            =   ""      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   18      TextUnit        =   0      Top             =   6      Underline       =   ""      Visible         =   True      Width           =   393   End   Begin lookuptoolbar lookuptoolbar1      Enabled         =   True      Height          =   56      Index           =   -2147483648      InitialParent   =   ""      Left            =   463      LockedInPosition=   False      Scope           =   0      TabPanelIndex   =   0      Top             =   168      Visible         =   True      Width           =   100   End   Begin Canvas aniimage      AcceptFocus     =   ""      AcceptTabs      =   ""      AutoDeactivate  =   True      Backdrop        =   ""      DoubleBuffer    =   False      Enabled         =   True      EraseBackground =   True      Height          =   300      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   6      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   15      TabPanelIndex   =   0      TabStop         =   True      Top             =   6      UseFocusRing    =   True      Visible         =   True      Width           =   193   End   Begin GroupBox StatisticsBox      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Statistics"      Enabled         =   True      Height          =   147      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   209      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   16      TabPanelIndex   =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   148      Underline       =   ""      Visible         =   True      Width           =   184      Begin StaticText Ranking         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "StatisticsBox"         Italic          =   ""         Left            =   218         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         Text            =   "Ranked: "         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   193         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin StaticText Score         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "StatisticsBox"         Italic          =   ""         Left            =   218         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   0         Text            =   "Score:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   169         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin StaticText Favorites         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "StatisticsBox"         Italic          =   ""         Left            =   218         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   3         TabPanelIndex   =   0         Text            =   "Favorites:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   266         Underline       =   ""         Visible         =   True         Width           =   127      End      Begin StaticText Popularity         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "StatisticsBox"         Italic          =   ""         Left            =   218         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   4         TabPanelIndex   =   0         Text            =   "Popularity:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   238         Underline       =   ""         Visible         =   True         Width           =   127      End      Begin StaticText Members         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "StatisticsBox"         Italic          =   ""         Left            =   218         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   5         TabPanelIndex   =   0         Text            =   "Members:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   216         Underline       =   ""         Visible         =   True         Width           =   136      End   End   Begin GroupBox GroupBox1      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Information"      Enabled         =   True      Height          =   154      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   209      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   17      TabPanelIndex   =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   298      Underline       =   ""      Visible         =   True      Width           =   387      Begin StaticText Status         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         Italic          =   ""         Left            =   221         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         Text            =   "Status:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   366         Underline       =   ""         Visible         =   True         Width           =   220      End      Begin StaticText Type         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         Italic          =   ""         Left            =   221         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         Text            =   "Type:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   319         Underline       =   ""         Visible         =   True         Width           =   202      End      Begin StaticText Episodes         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         Italic          =   ""         Left            =   221         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   3         TabPanelIndex   =   0         Text            =   "Episodes:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   343         Underline       =   ""         Visible         =   True         Width           =   202      End      Begin StaticText Classification         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   18         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         Italic          =   ""         Left            =   221         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   True         Scope           =   0         TabIndex        =   4         TabPanelIndex   =   0         Text            =   "Classification:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   390         Underline       =   ""         Visible         =   True         Width           =   375      End      Begin StaticText Genre         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   35         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "GroupBox1"         Italic          =   ""         Left            =   222         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   True         Scope           =   0         TabIndex        =   5         TabPanelIndex   =   0         Text            =   "Genre:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   411         Underline       =   ""         Visible         =   True         Width           =   367      End   End   Begin StaticText alttitle      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   36      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   212      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   True      Scope           =   0      TabIndex        =   20      TabPanelIndex   =   0      Text            =   "Also known as:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   109      Underline       =   ""      Visible         =   True      Width           =   377   End   Begin httpsocket socket1      Address         =   ""      Height          =   32      Index           =   -2147483648      Left            =   650      LockedInPosition=   False      Port            =   0      Scope           =   0      TabPanelIndex   =   0      Top             =   140      Width           =   32      yield           =   0   End   Begin BevelButton DelSeries      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   0      Bevel           =   0      Bold            =   False      ButtonType      =   0      Caption         =   "Remove Series"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   False      HasMenu         =   0      Height          =   22      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   52      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      MenuValue       =   0      Scope           =   0      TabIndex        =   25      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   0      TextFont        =   "System"      TextSize        =   ""      TextUnit        =   0      Top             =   323      Underline       =   False      Value           =   False      Visible         =   True      Width           =   100   End   Begin TextArea SynopsisText      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      BackColor       =   16777215      Bold            =   ""      Border          =   False      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   73      HelpTag         =   ""      HideSelection   =   True      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   209      LimitText       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Mask            =   ""      Multiline       =   True      ReadOnly        =   True      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   True      TabIndex        =   26      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   30      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   390   End   Begin StaticText notonlist      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   79      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   430      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   True      Scope           =   0      TabIndex        =   28      TabPanelIndex   =   0      Text            =   "Series not on your list."      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   178      Underline       =   ""      Visible         =   False      Width           =   133   End   Begin GroupBox yourstatus      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Your Status"      Enabled         =   True      Height          =   147      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   405      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   24      TabPanelIndex   =   0      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   149      Underline       =   ""      Visible         =   True      Width           =   191      Begin StaticText watchstatus         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   26         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "yourstatus"         Italic          =   ""         Left            =   419         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   True         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         Text            =   "Status:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   173         Underline       =   ""         Visible         =   True         Width           =   113      End      Begin StaticText Episodeswatched         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "yourstatus"         Italic          =   ""         Left            =   419         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         Text            =   "Episodes:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   202         Underline       =   ""         Visible         =   True         Width           =   162      End      Begin StaticText yourscore         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "yourstatus"         Italic          =   ""         Left            =   419         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   0         Text            =   "Score"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   236         Underline       =   ""         Visible         =   True         Width           =   162      End      Begin StaticText Volumes         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "yourstatus"         Italic          =   ""         Left            =   417         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   3         TabPanelIndex   =   0         Text            =   ""         TextAlign       =   0         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   12         TextUnit        =   0         Top             =   262         Underline       =   ""         Visible         =   True         Width           =   153      End   End   Begin StaticText Note      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   41      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   6      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   True      Scope           =   0      TabIndex        =   29      TabPanelIndex   =   0      Text            =   ""      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   411      Underline       =   ""      Visible         =   True      Width           =   194   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  me.HasToolbarButton = false		  loadpopupmenu		End Sub	#tag EndEvent	#tag MenuHandler		Function FileClose() As Boolean Handles FileClose.Action			me.close			Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function FilePrint() As Boolean Handles FilePrint.Action			// Print Window			try			dim p as picture = newPicture(self.width,self.height,32)			dim g as graphics = p.graphics			dim printG as graphics = openprinterdialog(nil,self)			if g<> nil then			self.drawinto g,1,1			printG.drawPicture p,1,1			end if			catch			end try		End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Sub loadinfo()		  loaduserstatus		  // load anime infomation		  dim data as string		  socket1.setrequestheader "Authorization","Basic " + app.loginenc		  data= socket1.get("http://mal-api.com/anime/" + SeriesID + "?format=xml&mine=1" ,10)		  If data is nil then		    self.errboxshow("MAL Client OS X was not able to retrieve information on this title.", "Make sure your internet connection is working and try again.")		  else		    Dim XML As New XmlDocument		    XML.LoadXML(Data)		    Dim AppNode As XmlNode = XML.DocumentElement		    Dim CNode As XmlNode = AppNode.firstchild		    dim epi, t1, t2 as string		    dim genred as new dictionary		    dim i as integer		    meta = new dictionary		    // Reset Genre/Alt Titles		    Genre.text = "Genre:"		    alttitle.text = "Also known as:"		    //load data		    try		      While CNode <> Nil		        Select Case CNode.Name		        Case "Title"		          me.TrueWindow.title = CNode.FirstChild.Value + " - Anime Information"		          seriestitle.text = CNode.FirstChild.Value		        Case "Synopsis"		          synopsistext.text = replaceall(CNode.FirstChild.Value, "<br>",  "" + EndOfLine  + "" )		        Case "Episodes"		          If cnode.firstchild = nil then		            // to prevent nilobjectexception		            epi = "0"		            meta.value("episodes") = epi		            Episodes.text = "Episodes: Unknown"		          else		            epi = cnode.firstchild.value		            If epi = "0" then		              Episodes.text = "Episodes: Unknown"		              meta.value("episodes") = "0"		            else		              Episodes.text = "Episodes: " + epi		              meta.value("episodes") = epi		            end if		          end if		        Case "Rank"		          Ranking.text = "Ranked: " + CNode.FirstChild.Value		        Case "members_score"		          Score.text = "Score: " + CNode.FirstChild.Value + "/10"		        Case "Type"		          Type.text = "Type: " + CNode.FirstChild.Value		          meta.value("type") = CNode.FirstChild.Value		        Case "Classification"		          classification.text = "Classification: " + CNode.FirstChild.Value		        Case "Genre"		          i = i + 1		          genred.value(cstr(i)) = CNode.FirstChild.Value		        Case "popularity_rank"		          Popularity.text = "Popularity: " + CNode.FirstChild.Value		        Case "favorited_count"		          Favorites.text = "Favorites: " + CNode.FirstChild.Value		        Case  "members_count"		          members.text = "Members: " + CNode.FirstChild.Value		        Case  "synonym"		          t1 = CNode.FirstChild.Value		        Case  "english_title"		          t2 = CNode.FirstChild.Value		        Case "status"		          If window1.l.haskey(seriesid) = false then		            Status.text = "Status: " + CNode.FirstChild.Value		            meta.value("status") = CNode.FirstChild.Value		          end if		        Case "image_url"		          dim s as picture		          // Obtain the image		          s = getpictFromURL(CNode.FirstChild.Value)		          // Resizing Image to fit Canvas (aniimage)		          Dim p as New Picture(aniimage.Width,aniimage.Height,32) //creating new picture (width, height, depth)		          		          p.Graphics.DrawPicture (s,0,0,aniimage.width, aniimage.height,0,0,s.width, s.height)		          		          aniimage.Backdrop = p // loading the picture from memory to Aniipicture		          Aniimage.Refresh		          p = nil		          s= nil		        End Select		        CNode = CNode.NextSibling		      Wend		      if t1 = "" then		        alttitle.text = alttitle.text + " " + t2		      else		        alttitle.text = alttitle.text + " " + t1 + ", " + t2		      end if		      For i=1 to genred.Count		        If i = genred.count then		          Genre.text = Genre.text + " " + genred.value(cstr(i))		        else		          Genre.text = Genre.text + " " + genred.value(cstr(i)) + ", "		        end if		      next		    catch		      //MAL API is down, show warning		      Note.text = "Unable to load infromation from MAL due to API Changes. Notify Unofficial MAL API Developer ASAP."		    end try		    // release properties		    xml = nil		    appnode = nil		    cnode = nil		    data = ""		    t1= ""		    t2 = ""		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub loadmanga()		  loaduserstatus		  // load anime infomation		  dim data as string		  socket1.setrequestheader "Authorization","Basic " + app.loginenc		  data= socket1.get("http://mal-api.com/manga/" + SeriesID + "?format=xml&mine=1" ,10)		  If data is nil then		    self.errboxshow("MAL Client OS X was not able to retrieve information on this title.", "Make sure your internet connection is working and try again.")		  else		    Dim XML As New XmlDocument		    XML.LoadXML(Data)		    Dim AppNode As XmlNode = XML.DocumentElement		    Dim CNode As XmlNode = AppNode.firstchild		    dim epi, t1, t2 as string		    dim genred as new dictionary		    dim i as integer		    meta = new dictionary		    // Reset Genre/Alt Titles		    Genre.text = "Genre:"		    alttitle.text = "Also known as:"		    //load data		    try		      While CNode <> Nil		        Select Case CNode.Name		        Case "Title"		          me.TrueWindow.title = CNode.FirstChild.Value + " - Manga Information"		          seriestitle.text = CNode.FirstChild.Value		        Case "Synopsis"		          synopsistext.text = replaceall(CNode.FirstChild.Value, "<br>",  "" + EndOfLine  + "" )		        Case "chapters"		          If cnode.firstchild = nil then		            // to prevent nilobjectexception		            epi = "0"		            meta.value("chapters") = epi		            Episodes.text = "Chapters: Unknown"		          else		            epi = cnode.firstchild.value		            If epi = "0" then		              Episodes.text = "Chapters: Unknown"		              meta.value("chapters") = "0"		            else		              Episodes.text = "Chapters: " + epi		              meta.value("chapters") = epi		            end if		          end if		        Case "Rank"		          Ranking.text = "Ranked: " + CNode.FirstChild.Value		        Case "members_score"		          Score.text = "Score: " + CNode.FirstChild.Value + "/10"		        Case "volumes"		          If cnode.firstchild = nil then		            // to prevent nilobjectexception		            volcount= "0"		            meta.value("volumes") = volcount		            Type.text = "Volumes: Unknown"		          else		            volcount= cnode.firstchild.value		            If volcount= "0" then		              Type.text = "Volumes: Unknown"		              meta.value("volumes") = "0"		            else		              Type.text = "Volumes: " + volcount		              meta.value("volumes") = volcount		            end if		          end if		        Case "Classification"		          classification.text = "Classification: " + CNode.FirstChild.Value		        Case "Genre"		          i = i + 1		          genred.value(cstr(i)) = CNode.FirstChild.Value		        Case "popularity_rank"		          Popularity.text = "Popularity: " + CNode.FirstChild.Value		        Case "favorited_count"		          Favorites.text = "Favorites: " + CNode.FirstChild.Value		        Case  "members_count"		          members.text = "Members: " + CNode.FirstChild.Value		        Case  "synonym"		          t1 = CNode.FirstChild.Value		        Case  "english_title"		          t2 = CNode.FirstChild.Value		        Case "status"		          If window1.l.haskey(seriesid) = false then		            Status.text = "Status: " + CNode.FirstChild.Value		            meta.value("status") = CNode.FirstChild.Value		          end if		        Case "image_url"		          dim s as picture		          // Obtain the image		          s = getpictFromURL(CNode.FirstChild.Value)		          // Resizing Image to fit Canvas (aniimage)		          Dim p as New Picture(aniimage.Width,aniimage.Height,32) //creating new picture (width, height, depth)		          		          p.Graphics.DrawPicture (s,0,0,aniimage.width, aniimage.height,0,0,s.width, s.height)		          		          aniimage.Backdrop = p // loading the picture from memory to Aniipicture		          Aniimage.Refresh		          p = nil		          s= nil		        End Select		        CNode = CNode.NextSibling		      Wend		      if t1 = "" then		        alttitle.text = alttitle.text + " " + t2		      else		        alttitle.text = alttitle.text + " " + t1 + ", " + t2		      end if		      For i=1 to genred.Count		        If i = genred.count then		          Genre.text = Genre.text + " " + genred.value(cstr(i))		        else		          Genre.text = Genre.text + " " + genred.value(cstr(i)) + ", "		        end if		      next		    catch		      //MAL API is down, show warning		      Note.text = "Unable to load infromation from MAL due to API Changes. Notify Unofficial MAL API Developer ASAP."		    end try		    // release properties		    xml = nil		    appnode = nil		    cnode = nil		    data = ""		    t1= ""		    t2 = ""		  end if		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub loadpopupmenu()		  //Lookup Menu		  Dim lookupmenu as New MenuItem		  Dim MAL as New MenuItem		  Dim AniDB as New MenuItem		  Dim Tokyosho as New MenuItem		  Dim Melative as New MenuItem		  		  // Append Menu Text		  // Lookup Menu		  MAL.Text="Open MAL Page"		  AniDB.Text="Find at AniDB"		  Tokyosho.text="Find at TokyoTosho"		  Melative.text = "Find at Melative"		  		  // Append Menu		  // lookup menu		  lookupmenu.Append MAL		  lookupmenu.Append AniDB		  lookupmenu.Append Tokyosho		  lookupmenu.Append Melative		  		  //Apply Menu to the toolbaritem		  lookuptoolbar1.open.DropdownMenu = lookupmenu		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub loaduserstatus()		  dim t as new dictionary		  dim epi as string		  If window1.l.haskey(seriesid) = true then		    yourstatus.visible = true		    lookuptoolbar1.AddList.enabled = false		    lookuptoolbar1.updateinfo.enabled = true		    DelSeries.visible = true		    notonlist.visible = false		    // load user info from list		    t = window1.l.value(seriesid)		    If listtype = "anime" then		      watchstatus.text = "Status: " + t.Value("watched_status")		      epi = t.Value("episodes")		      If epi = "0" then		        episodeswatched.text = "Episodes: " + t.Value("watched_episodes")		      else		        episodeswatched.text = "Episodes: " + t.Value("watched_episodes")+ "/" + epi		      end if		      epiwatch = t.Value("watched_episodes")		    else		      watchstatus.text = "Status: " + t.Value("read_status")		      epi = t.Value("chapters")		      If epi = "0" then		        episodeswatched.text = "Chapters: " + t.Value("chapters_read")		      else		        episodeswatched.text = "Chapters: " + t.Value("chapters_read")+ "/" + epi		      end if		      volcount = t.value("volumes")		      If volcount = "0" then		        volumes.text = "Volumes: " + t.Value("volumes_read")		      else		        volumes.text = "Volumes: " + t.Value("volumes_read")+ "/" + volcount		      end if		      epiwatch = t.Value("chapters_read")		    end if		    yourscore.text = "Score: " + t.Value("score")		    Status.text = "Status: " + t.value("status")		  else		    yourstatus.visible = false		    lookuptoolbar1.AddList.enabled = true		    lookuptoolbar1.updateinfo.enabled = false		    DelSeries.visible = false		    notonlist.visible = true		  end if		End Sub	#tag EndMethod	#tag Property, Flags = &h0		epiwatch As string	#tag EndProperty	#tag Property, Flags = &h0		listtype As string	#tag EndProperty	#tag Property, Flags = &h0		meta As dictionary	#tag EndProperty	#tag Property, Flags = &h0		seriesid As string	#tag EndProperty	#tag Property, Flags = &h0		volcount As string	#tag EndProperty#tag EndWindowCode#tag Events lookuptoolbar1	#tag Event		Sub Action(item As ToolItem)		  Select Case Item.Name		  case "addlist"		    If listtype = "Anime" then		      If self.addseries(seriesid, seriestitle.text, meta.value("status"),meta.value("episodes"),meta.value("type")) = true then		        loadinfo		      end if		    else		      If self.addmanga(seriesid, seriestitle.text, meta.value("status"),meta.value("chapters"),meta.value("volumes")) = true then		        loadinfo		      end if		    end if		  Case "updateinfo"		    If listtype = "Anime" then		      If self.UpdateStatus(seriesid) = true then		        loaduserstatus		      end if		    else		      If self.UpdateStatusManga(seriesid) = true then		        loaduserstatus		      end if		    end if		  case "melupdatebut"		    If app.prefs.root.GetBoolean("MelativeUpdates",false) = true then		      dim mu as new melupdatewindow		      mu.titletext.Text = seriestitle.text		      mu.truewindow.Title = "Post Melative Update - " + seriestitle.text		      if yourstatus.visible = false then		      else		        mu.epi.text= epiwatch		        mu.checkbox1.value = true		      end if		      mu.Show		    else		      errboxshowdialog("MAL Client OS X was unable to post a melative update on this series.","You must configure your melative credentials before you can post a melative update on this series. Configure your credentials, enable melative updating and try again.")		    end if		  case "email"		    If listtype = "anime" then		      showurl "mailto:?subject=Anime Suggestion - " + seriestitle.caption + "&body=" + seriestitle.caption + " - http://myanimelist.net/anime.php?id=" + seriesid		    else		      showurl "mailto:?subject=Manga Suggestion - " + seriestitle.caption + "&body=" + seriestitle.caption + " - http://myanimelist.net/manga.php?id=" + seriesid		    end if		  End Select		End Sub	#tag EndEvent	#tag Event		Sub DropDownMenuAction(item As ToolItem, hitItem As MenuItem)		  select case hititem.Text		    		  case "Open MAL Page"		    If listtype = "Anime" then		      ShowURL "http://myanimelist.net/anime.php?id=" + seriesid		    else		      ShowURL "http://myanimelist.net/manga.php?id=" + seriesid		    end if		  case "Find at AniDB"		    If listtype = "Anime" then		      showURL "http://anidb.net/perl-bin/animedb.pl?show=animelist&adb.search=" + EncodeURLComponent(SeriesTitle.caption) + "&do.search=search"		    else		      Beep		    end if		  case "Find at TokyoTosho"		    showURL "http://www.tokyotosho.info/search.php?terms=" + EncodeURLComponent(SeriesTitle.caption) + "&type=0"		  case "Find at Melative"		    If listtype = "Anime" then		      showURL "http://melative.com/anime/" + EncodeURLComponent(SeriesTitle.caption)		    else		      showURL "http://melative.com/manga/" + EncodeURLComponent(SeriesTitle.caption)		    end if		  end select		End Sub	#tag EndEvent#tag EndEvents#tag Events DelSeries	#tag Event		Sub Action()		  if self.deleteseries(seriesid,listtype) = true then		    If listtype = window1.List then		      loaduserstatus		    end if		  end if		  		End Sub	#tag EndEvent#tag EndEvents