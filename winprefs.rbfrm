#tag WindowBegin Window winprefs   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   True   Composite       =   True   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   2.75e+2   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   1408782882   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   False   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "General"   Visible         =   True   Width           =   6.0e+2   Begin PrefsToolbar PrefsToolbar1      Enabled         =   True      Height          =   71      Index           =   -2147483648      InitialParent   =   ""      Left            =   643      LockedInPosition=   False      Scope           =   0      TabPanelIndex   =   0      Top             =   125      Visible         =   True      Width           =   104   End   Begin PagePanel PagePanel1      AutoDeactivate  =   True      Enabled         =   True      Height          =   275      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      PanelCount      =   3      Panels          =   ""      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      Top             =   0      Value           =   2      Visible         =   True      Width           =   600      Begin StaticText StaticText1         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   57         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   1         Text            =   "Login"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   14         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin CheckBox CheckBox1         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Enable Automatic Login"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   57         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         State           =   0         TabIndex        =   1         TabPanelIndex   =   1         TabStop         =   True         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   38         Underline       =   ""         Value           =   False         Visible         =   True         Width           =   212      End      Begin StaticText StaticText4         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   50         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   78         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   True         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   1         Text            =   "Enabling this option will make MAL Client OS X log you in automatically using your stored password. If Remember Password isn't checked, this option cannot be enabled."         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   11         TextUnit        =   0         Top             =   62         Underline       =   ""         Visible         =   True         Width           =   465      End      Begin PushButton PushButton1         AutoDeactivate  =   False         Bold            =   ""         Cancel          =   ""         Caption         =   "Check Nowâ€¦"         Default         =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   247         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   3         TabStop         =   True         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   93         Underline       =   ""         Visible         =   True         Width           =   106      End      Begin StaticText StaticText3         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   54         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   12         TabPanelIndex   =   3         Text            =   "Automatic Updates\r"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   14         Underline       =   ""         Visible         =   True         Width           =   168      End      Begin StaticText token         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   49         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   2         Text            =   "Your Token is:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   11         TextUnit        =   0         Top             =   175         Underline       =   ""         Visible         =   True         Width           =   103      End      Begin CheckBox enableupdating         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Enable Melative Updating"         DataField       =   ""         DataSource      =   ""         Enabled         =   False         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   49         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         State           =   0         TabIndex        =   1         TabPanelIndex   =   2         TabStop         =   True         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   143         Underline       =   ""         Value           =   False         Visible         =   True         Width           =   301      End      Begin StaticText StaticText5         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   12         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   366         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   True         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   2         Text            =   "Get a Melative Account"         TextAlign       =   0         TextColor       =   204         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   147         Underline       =   True         Visible         =   True         Width           =   136      End      Begin PushButton vert         AutoDeactivate  =   True         Bold            =   ""         Cancel          =   ""         Caption         =   "Verify"         Default         =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   409         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   3         TabPanelIndex   =   2         TabStop         =   True         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   109         Underline       =   ""         Visible         =   True         Width           =   117      End      Begin TextField TextField1         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         BackColor       =   16777215         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   157         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Password        =   True         ReadOnly        =   ""         Scope           =   0         TabIndex        =   4         TabPanelIndex   =   2         TabStop         =   True         Text            =   ""         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   113         Underline       =   ""         UseFocusRing    =   True         Visible         =   True         Width           =   218      End      Begin StaticText StaticText6         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   52         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   5         TabPanelIndex   =   2         Text            =   "Password:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   114         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin StaticText StaticText7         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   53         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   6         TabPanelIndex   =   2         Text            =   "Username:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   83         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin TextField TextField2         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         BackColor       =   16777215         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   157         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   7         TabPanelIndex   =   2         TabStop         =   True         Text            =   ""         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   82         Underline       =   ""         UseFocusRing    =   True         Visible         =   True         Width           =   218      End      Begin PushButton PushButton2         AutoDeactivate  =   True         Bold            =   ""         Cancel          =   ""         Caption         =   "Remove Tokens"         Default         =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   409         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         TabIndex        =   8         TabPanelIndex   =   2         TabStop         =   True         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   81         Underline       =   ""         Visible         =   True         Width           =   117      End      Begin StaticText StaticText8         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   37         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   53         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   True         Scope           =   0         TabIndex        =   9         TabPanelIndex   =   2         Text            =   "Enabling this option will post a update automatically when you update your MAL Status. Your account must be verified before this option can be chosen. Then a Auth token will be created."         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   42         Underline       =   ""         Visible         =   True         Width           =   499      End      Begin StaticText StaticText9         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   52         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   10         TabPanelIndex   =   2         Text            =   "Melative"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   16         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin CheckBox CheckBox2         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Check for Prerelease Builds"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   "This will make Sparkle check for experimental builds instead of the stable branch updates. Note that changing Appcasts will make Sparkle prompt for Automatic Updates on application launch the next time you launch the program."         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   202         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         State           =   0         TabIndex        =   13         TabPanelIndex   =   3         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   39         Underline       =   ""         Value           =   False         Visible         =   True         Width           =   212      End      Begin CheckBox CheckBox3         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Check for Updates Automatically"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   "Have Sparkle check for new Melative Library updates. If you are using Snow Leopard, you should not select this option."         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   202         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Scope           =   0         State           =   0         TabIndex        =   14         TabPanelIndex   =   3         TabStop         =   True         TextFont        =   "System"         TextSize        =   0         TextUnit        =   0         Top             =   65         Underline       =   ""         Value           =   False         Visible         =   True         Width           =   228      End      Begin StaticText StaticText10         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   130         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   True         LockRight       =   ""         LockTop         =   True         Multiline       =   ""         Scope           =   0         TabIndex        =   15         TabPanelIndex   =   3         Text            =   "Last Updated:"         TextAlign       =   1         TextColor       =   &h000000         TextFont        =   "System"         TextSize        =   11         TextUnit        =   0         Top             =   127         Underline       =   ""         Visible         =   True         Width           =   340      End   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Close()		  // Save Preferences		  app.prefs.Save		End Sub	#tag EndEvent	#tag Event		Sub Open()		  self.SlideResize(600,112)		  // Disable Toggle Button		  me.hastoolbarbutton = false		  		  		  if app.prefs.root.GetBoolean("RememberPassword",false) = false then		    checkbox1.enabled = false		  else		    		  end if		  		  If  app.prefs.root.GetString("MelativeToken") = "" then		    enableupdating.enabled = false		  else		    enableupdating.enabled = true		  end if		End Sub	#tag EndEvent	#tag MenuHandler		Function EditPreferences() As Boolean Handles EditPreferences.Action			winprefs.show			Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileClose() As Boolean Handles FileClose.Action			me.close			Return True					End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Sub removesparkleplist()		  try		    //remove Sparkle plist		    dim f as folderitem		    f = SpecialFolder.Preferences.child("MAL Client OSX.plist")		    f.Delete		  catch		  end try		End Sub	#tag EndMethod#tag EndWindowCode#tag Events PrefsToolbar1	#tag Event		Sub Action(item As ToolItem)		  Select Case Item.Name		  Case "tblGeneral"		    pagepanel1.visible = false		    self.SlideResize(600,112)		    pagepanel1.value = 0		    pagepanel1.visible = true		    winprefs.title = "General"		    me.tblGeneral.Pushed = true		  Case "melative"		    pagepanel1.visible = false		    self.SlideResize(600,223)		    pagepanel1.value = 1		    pagepanel1.visible = true		    winprefs.title = "Melative"		    me.melative.Pushed = true		  Case "tblMisc"		    pagepanel1.visible = false		    self.SlideResize(600,160)		    pagepanel1.value = 2		    winprefs.title = "Misc"		    pagepanel1.visible = true		    me.tblMisc.pushed = true		  End Select		End Sub	#tag EndEvent#tag EndEvents#tag Events CheckBox1	#tag Event		Sub Open()		  checkbox1.value = app.prefs.root.GetBoolean("AutoLogin",false)		End Sub	#tag EndEvent	#tag Event		Sub Action()		  app.prefs.root.SetBoolean("AutoLogin", me.value)		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton1	#tag Event		Sub Action()		  Sparkle.CheckForUpdates true		  Sparkle.CheckStatus		End Sub	#tag EndEvent#tag EndEvents#tag Events token	#tag Event		Sub Open()		  me.text = "Your token is: " + app.prefs.root.GetString("MelativeToken")		End Sub	#tag EndEvent#tag EndEvents#tag Events enableupdating	#tag Event		Sub Action()		  app.prefs.root.SetBoolean("MelativeUpdates", me.value)		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.value = app.prefs.root.GetBoolean("MelativeUpdates",false)		End Sub	#tag EndEvent#tag EndEvents#tag Events StaticText5	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  showurl "http://melative.com/register"		End Function	#tag EndEvent#tag EndEvents#tag Events vert	#tag Event		Sub Action()		  If TextField1.text = ""  then		    // no username error		    self.errboxshow("MAL Client OS X was unable to vertify your melative account since you didn't enter a username.","Enter a valid username or password and try logging in again")		  else		    If Textfield2.text="" then		      // no password error		      self.errboxshow("MAL Client OS X was unable to vertify your melative account since you didn't enter a password.","Enter a valid password and try logging in again. ")		    else		      // using API to check credentials		      dim data as string		      dim socket1 as new httpsocket		      socket1.yield=true		      socket1.setrequestheader "Authorization","Basic " + EncodeBase64(TextField2.text + ":" + TextField1.text)		      data = socket1.get("http://melative.com/api/account/verify_credentials.xml",10)		      If socket1.httpstatuscode = 200 then		        // login is a success		        // Store Password and Username		        app.prefs.root.SetString("MelativeToken",EncodeBase64(TextField2.text + ":" + TextField1.text))		        enableupdating.enabled = true		        token.text =  "Your token is: "  + app.prefs.root.GetString("MelativeToken")		      elseif  socket1.httpstatuscode = 401  then		        self.errboxshow("MAL Client OS X was unable to vertify your melative account since you don't have the correct Username and/or Password.","Check your username and password and try logging in again.")		      else		        // if login fails		        self.errboxshow("MAL Client OS X was unable to vertify your melative account since it cannot connect to the server. ", "Check your internet connection and try loging in again.")		      end if		    end if		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton2	#tag Event		Sub Action()		  Dim d as New MessageDialog //declare the MessageDialog object		  Dim b as MessageDialogButton //for handling the result		  d.icon=MessageDialog.GraphicCaution //display warning icon		  d.ActionButton.Caption="Remove"		  d.CancelButton.Default = true // don't make Remove the default button.		  d.CancelButton.Visible=True    //show the Cancel button		  d.Message="Are you sure you want to remove your Melative Auth token?"		  d.Explanation="Once removed, this operation cannot be undone."		  b=d.ShowModalWithin(self.TrueWindow) //display the dialog		  Select Case b //determine which button was pressed.		  Case d.ActionButton		    //user pressed remove		    app.prefs.root.SetString("MelativeToken","")		    enableupdating.state = checkbox.checkedstates.Unchecked		    enableupdating.enabled = false		    app.prefs.root.SetBoolean("MelativeUpdates", false)		    token.text =  "Your token is: "		  Case d.CancelButton		    //user pressed Cancel		  End select		End Sub	#tag EndEvent#tag EndEvents#tag Events CheckBox2	#tag Event		Sub Action()		  // Save setting		  app.prefs.root.SetBoolean("ExpUpdates", me.value)		  // Change Appcast URL		  If me.value = true then		    app.prefs.root.SetString("SUFeedURL",  "http://chikorita157.notcliche.com/malclientosx/appcastexp.xml")		    Sparkle.UserDefault("SUFeedURL") = "http://chikorita157.notcliche.com/malclientosx/appcastexp.xml"		  else		    app.prefs.root.SetString("SUFeedURL",  "http://chikorita157.notcliche.com/malclientosx/appcastexp.xml")		    Sparkle.UserDefault("SUFeedURL") = "http://chikorita157.notcliche.com/malclientosx/appcast.xml"		  end if		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.value = app.prefs.root.GetBoolean("ExpUpdates",false)		End Sub	#tag EndEvent#tag EndEvents#tag Events CheckBox3	#tag Event		Sub Action()		  app.prefs.root.SetBoolean("SUEnableAutomaticChecks", me.value)		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.value = app.prefs.root.GetBoolean("SUEnableAutomaticChecks",false)		End Sub	#tag EndEvent#tag EndEvents#tag Events StaticText10	#tag Event		Sub Open()		  dim d as date		  d = app.prefs.root.GetDate("SULastCheckTime")		  me.text = "Last Checked: " + d.longdate + " " + d.longtime		End Sub	#tag EndEvent#tag EndEvents