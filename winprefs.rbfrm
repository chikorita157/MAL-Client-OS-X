#tag WindowBegin Window winprefs   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   True   Composite       =   True   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   2.75e+2   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   1408782882   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   False   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "General"   Visible         =   True   Width           =   6.0e+2   Begin PrefsToolbar PrefsToolbar1      Enabled         =   True      Height          =   71      Index           =   -2147483648      InitialParent   =   ""      Left            =   643      LockedInPosition=   False      Scope           =   0      TabPanelIndex   =   0      Top             =   124      Visible         =   True      Width           =   104   End   Begin PagePanel PagePanel1      AutoDeactivate  =   True      Enabled         =   True      Height          =   275      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      PanelCount      =   2      Panels          =   ""      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      Top             =   0      Value           =   1      Visible         =   True      Width           =   600      Begin StaticText StaticText1         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   57         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   ""         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   1         Text            =   "Login"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   14         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin CheckBox CheckBox1         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Enable Automatic Login"         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   57         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Scope           =   0         State           =   0         TabIndex        =   1         TabPanelIndex   =   1         TabStop         =   True         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   38         Underline       =   ""         Value           =   False         Visible         =   True         Width           =   212      End      Begin StaticText StaticText4         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   50         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   78         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   True         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   1         Text            =   "Enabling this option will make MAL Client OS X log you in automatically using your stored password. If Remember Password isn't checked, this option cannot be enabled."         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   11         TextUnit        =   0         Top             =   62         Underline       =   ""         Visible         =   True         Width           =   465      End      Begin StaticText token         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   50         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   ""         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   2         Text            =   "Your Token is:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   11         TextUnit        =   0         Top             =   234         Underline       =   ""         Visible         =   True         Width           =   103      End      Begin CheckBox enableupdating         AutoDeactivate  =   True         Bold            =   ""         Caption         =   "Enable Melative Updating"         DataField       =   ""         DataSource      =   ""         Enabled         =   False         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   50         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Scope           =   0         State           =   0         TabIndex        =   6         TabPanelIndex   =   2         TabStop         =   True         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   202         Underline       =   ""         Value           =   False         Visible         =   True         Width           =   301      End      Begin StaticText StaticText9         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   12         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   367         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   True         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   2         Text            =   "Get a Melative Account"         TextAlign       =   0         TextColor       =   204         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   206         Underline       =   True         Visible         =   True         Width           =   136      End      Begin PushButton vert         AutoDeactivate  =   True         Bold            =   ""         Cancel          =   ""         Caption         =   "Verify"         Default         =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   410         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Scope           =   0         TabIndex        =   5         TabPanelIndex   =   2         TabStop         =   True         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   168         Underline       =   ""         Visible         =   True         Width           =   117      End      Begin TextField TextField2         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         BackColor       =   16777215         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   158         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Mask            =   ""         Password        =   True         ReadOnly        =   ""         Scope           =   0         TabIndex        =   4         TabPanelIndex   =   2         TabStop         =   True         Text            =   ""         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   172         Underline       =   ""         UseFocusRing    =   True         Visible         =   True         Width           =   218      End      Begin StaticText StaticText8         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   53         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   ""         Scope           =   0         TabIndex        =   5         TabPanelIndex   =   2         Text            =   "Password:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   173         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin StaticText StaticText7         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   54         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   ""         Scope           =   0         TabIndex        =   6         TabPanelIndex   =   2         Text            =   "Username:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   142         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin TextField TextField1         AcceptTabs      =   ""         Alignment       =   0         AutoDeactivate  =   True         BackColor       =   16777215         Bold            =   ""         Border          =   True         CueText         =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   22         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   158         LimitText       =   0         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Mask            =   ""         Password        =   ""         ReadOnly        =   ""         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   2         TabStop         =   True         Text            =   ""         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   141         Underline       =   ""         UseFocusRing    =   True         Visible         =   True         Width           =   218      End      Begin PushButton PushButton2         AutoDeactivate  =   True         Bold            =   ""         Cancel          =   ""         Caption         =   "Remove Tokens"         Default         =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   410         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Scope           =   0         TabIndex        =   3         TabPanelIndex   =   2         TabStop         =   True         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   140         Underline       =   ""         Visible         =   True         Width           =   117      End      Begin StaticText StaticText6         AutoDeactivate  =   True         Bold            =   ""         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   37         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   54         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   True         Scope           =   0         TabIndex        =   9         TabPanelIndex   =   2         Text            =   "Enabling this option will post a update automatically when you update your MAL Status. Your account must be verified before this option can be chosen. Then a Auth token will be created."         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   101         Underline       =   ""         Visible         =   True         Width           =   499      End      Begin StaticText StaticText5         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   53         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   ""         Scope           =   0         TabIndex        =   10         TabPanelIndex   =   2         Text            =   "Melative:"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   75         Underline       =   ""         Visible         =   True         Width           =   100      End      Begin PushButton PushButton1         AutoDeactivate  =   False         Bold            =   ""         Cancel          =   ""         Caption         =   "Check Now…"         Default         =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   250         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   2         TabStop         =   True         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   43         Underline       =   ""         Visible         =   True         Width           =   106      End      Begin StaticText StaticText3         AutoDeactivate  =   True         Bold            =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "PagePanel1"         Italic          =   ""         Left            =   54         LockBottom      =   ""         LockedInPosition=   False         LockLeft        =   ""         LockRight       =   ""         LockTop         =   ""         Multiline       =   ""         Scope           =   0         TabIndex        =   12         TabPanelIndex   =   2         Text            =   "Automatic Updates:\r"         TextAlign       =   0         TextColor       =   0         TextFont        =   "System"         TextSize        =   13         TextUnit        =   0         Top             =   14         Underline       =   ""         Visible         =   True         Width           =   168      End   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  self.SlideResize(600,112)		  // Disable Toggle Button		  me.hastoolbarbutton = false		  		  		  if booleanrememberpassword = false then		    checkbox1.enabled = false		  else		    		  end if		  		  If prefs.StringMelAuth = "" then		    enableupdating.enabled = false		  else		    enableupdating.enabled = true		  end if		End Sub	#tag EndEvent	#tag MenuHandler		Function EditPreferences() As Boolean Handles EditPreferences.Action			winprefs.show			Return True					End Function	#tag EndMenuHandler	#tag MenuHandler		Function FileClose() As Boolean Handles FileClose.Action			me.close			Return True					End Function	#tag EndMenuHandler#tag EndWindowCode#tag Events PrefsToolbar1	#tag Event		Sub Action(item As ToolItem)		  Select Case Item.Name		  Case "tblGeneral"		    pagepanel1.visible = false		    self.SlideResize(600,112)		    me.tblGeneral.Pushed = true		    me.tblMisc.Pushed = false		    pagepanel1.value = 0		    pagepanel1.visible = true		    winprefs.title = "General"		  Case "tblMisc"		    pagepanel1.visible = false		    self.SlideResize(600,275)		    me.tblGeneral.Pushed = false		    me.tblMisc.Pushed = true		    pagepanel1.value = 1		    winprefs.title = "Misc"		    pagepanel1.visible = true		  End Select		End Sub	#tag EndEvent#tag EndEvents#tag Events CheckBox1	#tag Event		Sub Open()		  checkbox1.value = booleanautologin		End Sub	#tag EndEvent	#tag Event		Sub Action()		  booleanautologin = checkbox1.value		End Sub	#tag EndEvent#tag EndEvents#tag Events token	#tag Event		Sub Open()		  me.text = "Your token is: " + StringMelAuth		End Sub	#tag EndEvent#tag EndEvents#tag Events enableupdating	#tag Event		Sub Action()		  prefs.BooleanMelUpdates = me.value		End Sub	#tag EndEvent	#tag Event		Sub Open()		  me.value = booleanmelupdates		End Sub	#tag EndEvent#tag EndEvents#tag Events StaticText9	#tag Event		Function MouseDown(X As Integer, Y As Integer) As Boolean		  showurl "http://melative.com/register"		End Function	#tag EndEvent#tag EndEvents#tag Events vert	#tag Event		Sub Action()		  If TextField1.text = ""  then		    // no username error		    self.errboxshow("MAL Client OS X was unable to vertify your melative account since you didn't enter a username.","Enter a valid username or password and try logging in again")		  else		    If Textfield2.text="" then		      // no password error		      self.errboxshow("MAL Client OS X was unable to vertify your melative account since you didn't enter a password.","Enter a valid password and try logging in again. ")		    else		      // using API to check credentials		      dim data as string		      dim socket1 as new httpsocket		      socket1.yield=true		      // create and populate the form object		      dim form as New Dictionary		      form.value("user") = TextField1.text		      form.value("password") = TextField2.text		      // setup the socket to POST the form		      socket1.setFormData form		      data = socket1.post("http://melative.com/api/login.xml",10)		      If socket1.httpstatuscode = 200 then		        // login is a success		        // Store Password and Username		        prefs.StringmelAuth =  EncodeBase64(TextField1.text + ":" + TextField2.text)		        enableupdating.enabled = true		        token.text =  "Your token is: " + StringMelAuth		      elseif socket1.httpstatuscode = 401 then		        self.errboxshow("MAL Client OS X was unable to vertify your melative account since you don't have the correct Username and/or Password.","Check your username and password and try logging in again.")		      Else		        // if login fails		        self.errboxshow("MAL Client OS X was unable to vertify your melative account since it cannot connect to the server. ", "Check your internet connection and try loging in again.")		      end if		    end if		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton2	#tag Event		Sub Action()		  Dim d as New MessageDialog //declare the MessageDialog object		  Dim b as MessageDialogButton //for handling the result		  d.icon=MessageDialog.GraphicCaution //display warning icon		  d.ActionButton.Caption="Remove"		  d.CancelButton.Visible=True    //show the Cancel button		  d.Message="Are you sure you want to remove your Melative Auth token?"		  d.Explanation="Once removed, this operation cannot be undone."		  b=d.ShowModalWithin(self.TrueWindow) //display the dialog		  Select Case b //determine which button was pressed.		  Case d.ActionButton		    //user pressed remove		    Prefs.StringmelAuth = ""		    enableupdating.state = checkbox.checkedstates.Unchecked		    enableupdating.enabled = false		    prefs.BooleanMelUpdates = false		    token.text =  "Your token is: " + StringMelAuth		  Case d.CancelButton		    //user pressed Cancel		  End select		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton1	#tag Event		Sub Action()		  Sparkle.CheckForUpdates true		  Sparkle.CheckStatus		End Sub	#tag EndEvent#tag EndEvents